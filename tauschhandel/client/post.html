
<template name='post'>
	{{#contentFor "headerButtonLeft"}}
		{{>ionNavBackButton path="home" text="Posts"}}
	{{/contentFor}}

	{{#ionView}}
	  {{#ionContent}}
		<div class="card">
			<div class="item item-avatar">
				{{#if post.userPicture}}
					<img src="{{post.userPicture}}">
				{{else}}
					<img src="http://i.imgur.com/hzByj22b.jpg">
				{{/if}}
				<h2>{{post.userName}}</h2>
				<p style="font-style: italic">{{post.dateString}}</p>
			</div>
			<div class="item item-text-wrap">
				<h2>{{post.title}}</h2>
				<br>
				<div id='slidebox' style='width: 100%'>
					{{#ionSlideBox}}
						{{#each post.imageIDs}}
							{{#ionSlide class='light-bg'}}
								<img src="http://i.imgur.com/{{this}}l.jpg" width='100%'>
							{{/ionSlide}}
						{{/each}}
				     {{/ionSlideBox}}
				</div>
				<br>
				<p>{{post.text}}</p>
				<br>
				<p>tags: {{#each post.tags}} {{this}} {{/each}}</p>
				<br>
			</div>
			<div class="item tabs tabs-secondary tabs-icon-left">
				{{#if isMyPost}}
					<a id="edit" class="tab-item" href="#" style=''>
				      <i class="icon ion-edit"></i>
				      Edit
					</a>
				{{else}}
					<a id="like" class="tab-item" href="#" style='{{#if isOnWatchList }}color: red {{/if}}'>
				      <i class="icon ion-android-favorite"></i>
				      Like
					</a>
				{{/if}}
				<a id="QAndAButton" class="tab-item" href="#" style='{{#if QAndAOpened}} color: blue {{/if}}'>
					<i class="icon ion-chatbubble"></i>
					Q&A
				</a>
				<a class="tab-item" href="#">
					<i class="icon ion-share"></i>
					Share
				</a>
			</div>
		</div>

		{{#if QAndAOpened}}
			<div class='card'>
				<div class="item item-divider">
					Fragen & Antworten
				</div>
				<div class="item item-text-wrap">
					{{> discussion}}
				</div>
			</div>
		{{/if}}

		{{#unless isMyPost}}
			<div class="padding">
				<button id="interesseMelden" class="button button-block button-outline button-assertive">
					{{#if hasInterest}}
						Interesse zur체ckziehen
					{{else}}
						Interesse anmelden
					{{/if}}
				</button>
			</div>
		{{/unless}}

		{{#if isMyPost}}
			{{#if esHatInteressenten}}
				{{> giveAway}}
			{{/if}}
		{{/if}}

	  {{/ionContent}}
	{{/ionView}}
</template>

<template name="giveAway">
	<div class="card">
		<div class="item item-divider">
			An jemanden vergeben
		</div>
		<div class="item item-text-wrap">
			{{#if post.vergebenAn}}
				<p>Wurde vergeben an <b>{{post.vergebenAnName}}</b></p>
				<button id="revert" class="button button-block button-outline button-assertive">
					R체ckg채ngig machen
				</button>
			{{else}}
				<p>Bitte w채hle einen Interessenten aus.</p>
				<div class="list">
					<label class="item item-input item-select">
						<div class="input-label">
							User
						</div>
						<select>
							{{#each interessenten}}
								<option value="{{_id}}">{{username}}</option>
							{{/each}}
						</select>
					</label>
				</div>
				<button id="giveAway" class="button button-block button-outline button-assertive">
					Dieser Person geben
				</button>
			{{/if}}
		</div>
	</div>
</template>

<template name="discussion">
	{{#if discussions.[0]}}
		{{#each discussions}}
			{{> discussionPair}}
		{{/each}}
	{{else}}
		<p>Hier scheint noch nichts zu sein. </p><br>
	{{/if}}
	{{#unless isMyPost}}	
		{{> createPostQuestion}}
	{{/unless}}
</template>

<template name="discussionPair">
	<p style="font-style: italic">Von {{questionerName}} am {{dateString}}</p>
	<div class="card">
		<div class="item item-text-wrap" style='background-color: #C18B8B'>
			<p>{{question}}</p>
		</div>
		<div class="item item-text-wrap" style='background-color: #F4D09A'>
			{{#if answer}}
				<p>{{answer}}</p>
			{{else}}
				{{#if isMyPost}}
					<label class="item item-input" style='display: none'>
						<textarea id='antwort' placeholder="Stelle eine Frage" rows="5" ></textarea>
					</label><br>
					<button id="antwortVerfassenButton" class='button button-balanced button-outline'>Antwort verfassen</button>
					<button id="frageBeantwortenButton" class='button button-balanced button-outline' style='display: none'>Antworten</button>
					<button id="cancel" class='button button-assertive button-outline' style='display: none'>Abbrechen</button>
				{{else}}
					<p style="font-style: italic"> Noch keine Antwort </p>
				{{/if}}
			{{/if}}
		</div>
	</div>
</template>

<template name='createPostQuestion'>
	<br>
	<form role='form'>
		<div class="input-group">
		<label class="item item-input" style="border: 1px solid black; border-color: green">
			<textarea id='newQuestion' placeholder="Stelle eine Frage" rows="5"></textarea>
		</label>
		<button id='newQuestionButton' class="button button-balanced button-outline" type="button">Abschicken!</button>
		</div>
	</form>
</template>
